# This file is part of Unirec output plugin for IPFIXcol2
#
# Entries in this file show mapping from IPFIX Information Elements to UniRec
# fields. You can change setting by editing this file. Each entry consists
# of the following parameters:
#  - UniRec field name
#  - UniRec data type - one of the following:
#      int{8,16,32,64}, uint{8,16,32,64},
#      float, double, time, ipaddr, macaddr, char, string, bytes
#      int{8,16,32,64}*, uint{8,16,32,64}*,          // "array of" types
#      float*, double*, time*, ipaddr*, macaddr*     // "array of" types
#      string_trimmed                                // trimmed string (i.e. no tailing '\0')
#  - Comma separated list of IPFIX Information Elements identifiers
#      ("eXXidYY" where XX is Private Enterprise Number and YY is field ID)
#
# See ipfixcol2-unirec-output(1) for details
#
# Note:
#   IPFIX IEs "_internal_dbf_" and "_internal_lbf_" represents internal
#   conversion functions of UniRec plugin.

#UNIREC NAME                   UNIREC TYPE   IPFIX IEs        DESCRIPTION
# --- Basic fields ---
SRC_IP                         ipaddr        e0id8,e0id27     # IPv4 or IPv6 source address
DST_IP                         ipaddr        e0id12,e0id28    # IPv4 or IPv6 destination address
SRC_PORT                       uint16        e0id7            # Transport protocol source port
DST_PORT                       uint16        e0id11           # Transport protocol destination port
PROTOCOL                       uint8         e0id4            # Transport protocol
TCP_FLAGS                      uint8         e0id6            # TCP flags
BYTES                          uint64        e0id1            # Number of bytes in flow
PACKETS                        uint32        e0id2            # Number of packets in flow
TTL                            uint8         e0id192          # IP time to live
TOS                            uint8         e0id5            # IP type of service
TIME_FIRST                     time          e0id150,e0id152,e0id154,e0id156 # Time of the first packet of a flow
TIME_LAST                      time          e0id151,e0id153,e0id155,e0id157 # Time of the last packet of a flow
DIR_BIT_FIELD                  uint8         _internal_dbf_   # Bit field used for determining incoming/outgoing flow (1 => Incoming, 0 => Outgoing)
LINK_BIT_FIELD                 uint64        _internal_lbf_   # Bit field of links on which was flow seen
SRC_MAC                        macaddr       e0id56
DST_MAC                        macaddr       e0id80

# --- Additional biflow fields ---
BYTES_REV                      uint64        e29305id1
PACKETS_REV                    uint32        e29305id2
TCP_FLAGS_REV                  uint8         e29305id6

# --- DNS specific fields ---
DNS_ID                         uint16        flowmon:dnsId             # DNS transaction id
DNS_FLAGS                      uint16        flowmon:dnsFlagsCodes     # DNS header flags
DNS_CNT_QUESTIONS              uint16        flowmon:dnsQuestionCount  # DNS questions
DNS_CNT_ANSWERS                uint16        flowmon:dnsAnswrecCount   # DNS answers
DNS_CNT_AUTHS                  uint16        flowmon:dnsAuthrecCount   # DNS auth. records
DNS_CNT_ADDIT                  uint16        flowmon:dnsAddtrecCount   # DNS additional records
DNS_Q_NAME                     string        flowmon:dnsQname          # DNS query name
DNS_Q_TYPE                     uint16        flowmon:dnsQtype          # DNS query type
DNS_Q_CLASS                    uint16        flowmon:dnsQclass         # DNS query class
DNS_RR_NAME                    string        flowmon:dnsCrrName        # DNS RR name
DNS_RR_TYPE                    uint16        flowmon:dnsCrrType        # DNS RR type
DNS_RR_CLASS                   uint16        flowmon:dnsCrrClass       # DNS RR class
DNS_RR_TTL                     uint32        flowmon:dnsCrrTtl         # DNS RR ttl
DNS_RR_RDATA                   bytes         flowmon:dnsCrrRdata       # DNS RR rdata
DNS_RR_RLENGTH                 uint16        flowmon:dnsCrrRdataLen    # DNS RR rlenght
# Note: Old fields DNS_RCODE, DNS_PSIDE and DNS_DO are not available anymore...

# --- SIP specific fields ---
VOIP_PACKET_TYPE               uint8         flowmon:voipPacketType
SIP_CALL_ID                    string        flowmon:sipCallId
SIP_CALLING_PARTY              string        flowmon:sipCallingParty
SIP_CALLED_PARTY               string        flowmon:sipCalledParty
SIP_VIA                        string        flowmon:sipVia
SIP_INVITE_RINGING_TIME        uint64        flowmon:sipInviteRingingTime
SIP_OK_TIME                    uint64        flowmon:sipOkTime
SIP_BYE_TIME                   uint64        flowmon:sipByeTime
SIP_RTP_IP4                    ipaddr        flowmon:sipRtpIp4
SIP_RTP_IP6                    ipaddr        flowmon:sipRtpIp6
SIP_RTP_AUDIO                  uint16        flowmon:sipRtpAudio
SIP_RTP_VIDEO                  uint16        flowmon:sipRtpVideo
SIP_STATS                      bytes         flowmon:sipStats
RTP_CODEC                      uint8         flowmon:rtpCodec
RTP_JITTER                     uint32        flowmon:rtpJitter
RTCP_LOST                      uint32        flowmon:rtcpLost
RTCP_PACKETS                   uint64        flowmon:rtcpPackets
RTCP_OCTETS                    uint64        flowmon:rtcpOctets
RTCP_SOURCE_COUNT              uint8         flowmon:rtcpSourceCount

# --- Service discovery protocols (SSDP, DNS-SD, NetBIOS) ---
SSDP_LOCATION_PORT             uint16        e8057id900                   # service port
SSDP_SERVER                    string        e8057id901                   # server info
SSDP_USER_AGENT                string        e8057id902                   # list of user agents (semicolon-separated)
SSDP_NT                        string        e8057id903                   # list of advertised service URNs (semicolon-separated)
SSDP_ST                        string        e8057id904                   # list of queried service URNs (semicolon-separated)
DNSSD_QUERIES                  string        e8057id905                   # list of queries for services (format: [service_instance_name;][...])
DNSSD_RESPONSES                string        e8057id906                   # list of advertised services (format: [service_instance_name;service_port;service_target;hinfo;txt;][...])
NB_NAME                        string        e8057id831                   # NetBIOS Name Service name
NB_SUFFIX                      uint8         e8057id832                   # NetBIOS Name Service suffix

# --- HTTP elements ---
HTTP_REQUEST_HOST              string        flowmon:httpHost
HTTP_REQUEST_URL               string        flowmon:httpUrl
HTTP_REQUEST_REFERER           string        flowmon:httpReferer
HTTP_METHOD_MASK               uint16        flowmon:httpMethodMask
HTTP_RESPONSE_CONTENT_TYPE     string        flowmon:httpContentType
HTTP_RESPONSE_STATUS_CODE      uint16        flowmon:httpStatusCode
HTTP_UA_OS                     uint16        flowmon:httpUaOs
HTTP_UA_OS_MAJ                 uint16        flowmon:httpUaOsMaj
HTTP_UA_OS_MIN                 uint16        flowmon:httpUaOsMin
HTTP_UA_OS_BLD                 uint16        flowmon:httpUaOsBld
HTTP_UA_APP                    uint16        flowmon:httpUaApp
HTTP_UA_APP_MAJ                uint16        flowmon:httpUaAppMaj
HTTP_UA_APP_MIN                uint16        flowmon:httpUaAppMin
HTTP_UA_APP_BLD                uint16        flowmon:httpUaAppBld

# --- Other fields ---
APP_ID                         bytes         e0id95           # Application ID from libprotoident / NBAR2 / Flowmon's NBAR plugin

# --- Flowmon TLS fields
TLS_CONTENT_TYPE               uint8         flowmon:tlsContentType       # tlsContentType
TLS_HANDSHAKE_TYPE             uint32        flowmon:tlsHandshakeType     # https://tools.ietf.org/html/rfc5246#appendix-A.4
TLS_SETUP_TIME                 uint64        flowmon:tlsSetupTime         # tlsSetupTime
TLS_SERVER_VERSION             uint16        flowmon:tlsServerVersion     # 8b major and 8b minor, 0x0303 ~ TLS1.2
TLS_SERVER_RANDOM              bytes         flowmon:tlsServerRandom      # tlsServerRandom
TLS_SERVER_SESSIONID           bytes         flowmon:tlsServerSessionId   # tlsServerSessionId
TLS_CIPHER_SUITE               uint16        flowmon:tlsCipherSuite       # https://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml#tls-parameters-4
TLS_ALPN                       string        flowmon:tlsAlpn              # TLS Application-Layer Protocol Negotiation https://www.iana.org/assignments/tls-extensiontype-values/tls-extensiontype-values.xhtml#alpn-protocol-ids
TLS_SNI                        string        flowmon:tlsSni               # Server Name Indication https://en.wikipedia.org/wiki/Server_Name_Indication
TLS_SNI_LENGTH                 uint16        flowmon:tlsSniLength         # Length of TLS_SNI field
TLS_CLIENT_VERSION             uint16        flowmon:tlsClientVersion     # tlsClientVersion
TLS_CIPHER_SUITES              bytes         flowmon:tlsCipherSuites      # List of 2B ciphers, beware of network byte order. See https://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml#tls-parameters-4
TLS_CLIENT_RANDOM              bytes         flowmon:tlsClientRandom      # tlsClientRandom
TLS_CLIENT_SESSIONID           bytes         flowmon:tlsClientSessionId   # tlsClientSessionId
TLS_EXTENSION_TYPES            bytes         flowmon:tlsExtensionTypes    # tlsExtensionTypes
TLS_EXTENSION_LENGTHS          bytes         flowmon:tlsExtensionLengths  # tlsExtensionLengths
TLS_ELLIPTIC_CURVES            bytes         flowmon:tlsEllipticCurves    # tlsEllipticCurves
TLS_EC_POINTFORMATS            bytes         flowmon:tlsEcPointFormats    # tlsEcPointFormats
TLS_CLIENT_KEYLENGTH           int32         flowmon:tlsClientKeyLength   # Length of client's key
TLS_ISSUER_CN                  string        flowmon:tlsIssuerCn          # Common name of certificate issuer
TLS_SUBJECT_CN                 string        flowmon:tlsSubjectCn         # Certificate Common Name
TLS_SUBJECT_ON                 string        flowmon:tlsSubjectOn         # Certificate Organization Name
TLS_VALIDITY_NOTBEFORE         int64         flowmon:tlsValidityNotBefore # UNIX timestamp of certificate creation
TLS_VALIDITY_NOTAFTER          int64         flowmon:tlsValidityNotAfter  # UNIX timestamp of certificate expiration
TLS_SIGNATURE_ALG              uint16        flowmon:tlsSignatureAlg      # tlsSignatureAlg
TLS_PUBLIC_KEYALG              uint16        flowmon:tlsPublicKeyAlg      # tlsPublicKeyAlg
TLS_PUBLIC_KEYLENGTH           int32         flowmon:tlsPublicKeyLength   # tlsPublicKeyLength
TLS_JA_3FINGERPRINT            bytes         flowmon:tlsJa3Fingerprint    # tlsJa3Fingerprint

# --- Per-Packet Information elements ---
PPI_TLS_REC_LENGTHS            int16*        e0id291/e8057id1010          # basicList of TLS record lengths
PPI_TLS_REC_TIMES             uint16*        e0id291/e8057id1011          # basicList of TLS record timestamps
PPI_TLS_CONTENT_TYPES          uint8*        e0id291/e8057id1012          # basicList of TLS record content types
PPI_PKT_LENGTHS                int16*        e0id291/e8057id1013          # basicList of packet lengths
PPI_PKT_TIMES                   time*        e0id291/e8057id1014          # basicList of packet timestamps
PPI_PKT_FLAGS                   int8*        e0id291/e8057id1015          # basicList of packet TCP flags
PPI_PKT_DIRECTIONS              int8*        e0id291/e8057id1016          # basicList of packet directions
